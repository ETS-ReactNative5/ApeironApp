{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _constants = require(\"../../constants.js\");\n\nvar _Logo = _interopRequireDefault(require(\"../components/Logo\"));\n\nvar _Form = _interopRequireDefault(require(\"../components/Form\"));\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-community/async-storage\"));\n\nvar _reactNativeRouterFlux = require(\"react-native-router-flux\");\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _syncStorage = _interopRequireDefault(require(\"sync-storage\"));\n\nvar _jsxFileName = \"C:\\\\Users\\\\Luna\\\\Desktop\\\\Diplomski\\\\Android\\\\android_app\\\\src\\\\pages\\\\Login.js\";\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Login = function (_Component) {\n  (0, _inherits2.default)(Login, _Component);\n\n  var _super = _createSuper(Login);\n\n  function Login() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Login);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      errorHeader: \"\",\n      errorMessage: \"\",\n      hiddenErrorAlert: true,\n      email: \"\",\n      password: \"\",\n      redirect: false,\n      emailError: false,\n      passwordError: false,\n      openPasswordModal: false,\n      oldPasswordEmptyError: false,\n      newPasswordEmptyError: false,\n      newPasswordRetypeEmptyError: false,\n      newPasswordRetypeNotSameError: false,\n      errorPasswordHeader: \"\",\n      errorPasswordMessage: \"\",\n      hiddenPasswordErrorAlert: true\n    };\n\n    _this.handleEmailChange = function (event) {\n      _this.setState({\n        email: event.nativeEvent.text\n      });\n    };\n\n    _this.handlePasswordChange = function (event) {\n      _this.setState({\n        password: event.nativeEvent.text\n      });\n    };\n\n    _this.handleLogin = function () {\n      _this.setState({\n        hiddenErrorAlert: true,\n        emailError: false,\n        passwordError: false\n      });\n\n      if (_this.validateForm()) {\n        var loginDTO = {\n          email: _this.state.email,\n          password: _this.state.password\n        };\n        console.log(loginDTO);\n\n        _axios.default.post(_constants.BASE_URL + \"/api/auth/login\", loginDTO, {\n          validateStatus: function validateStatus() {\n            return true;\n          }\n        }).then(function (res) {\n          if (res.status === 401) {\n            _this.setState({\n              errorHeader: \"Bad credentials!\",\n              errorMessage: \"Wrong username or password.\",\n              hiddenErrorAlert: false\n            });\n          } else if (res.status === 500) {\n            _this.setState({\n              errorHeader: \"Bad credentials!\",\n              errorMessage: \"Wrong username or password.\",\n              hiddenErrorAlert: false\n            });\n          } else if (res.status === 302) {\n            _this.setState({\n              openPasswordModal: true\n            });\n          } else {\n            console.log(res.data);\n\n            _syncStorage.default.set(\"keyToken\", res.data.accessToken);\n\n            _syncStorage.default.set(\"keyRole\", JSON.stringify(res.data.roles));\n\n            _syncStorage.default.set(\"expireTime\", JSON.stringify(new Date(new Date().getTime() + res.data.expiresIn).getTime()));\n\n            console.log(_syncStorage.default.get('keyRole'));\n\n            _this.props.navigation.navigate('HomePage');\n          }\n        }).catch(function (err) {\n          console.log(\"ERRRR\" + err);\n        });\n      }\n    };\n\n    _this.validateForm = function () {\n      if (_this.state.email === \"\") {\n        _this.setState({\n          emailError: true\n        });\n\n        return false;\n      } else if (_this.state.password === \"\") {\n        _this.setState({\n          passwordError: true\n        });\n\n        return false;\n      }\n\n      return true;\n    };\n\n    _this.handleCloseAlert = function () {\n      _this.setState({\n        hiddenErrorAlert: true\n      });\n    };\n\n    _this.handlePasswordModalClose = function () {\n      _this.setState({\n        openPasswordModal: false\n      });\n    };\n\n    _this.handleCloseAlertPassword = function () {\n      _this.setState({\n        hiddenPasswordErrorAlert: true\n      });\n    };\n\n    return _this;\n  }\n\n  (0, _createClass2.default)(Login, [{\n    key: \"signup\",\n    value: function signup() {\n      _reactNativeRouterFlux.Actions.signup();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var navigate = this.props.navigation.navigate;\n      if (this.state.redirect) return _react.default.createElement(_reactRouterDom.Redirect, {\n        push: true,\n        to: \"/TShirtsWomen\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 35\n        }\n      });\n      return _react.default.createElement(_reactNative.View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 4\n        }\n      }, _react.default.createElement(_reactNative.Image, {\n        style: styles.image,\n        source: require(\"../images/01-APEIRON-LOGO-new.png\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 6\n        }\n      }), _react.default.createElement(_reactNative.View, {\n        style: styles.inputView,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 8\n        }\n      }, _react.default.createElement(_reactNative.TextInput, {\n        placeholder: \"Email address\",\n        className: \"form-control\",\n        id: \"name\",\n        type: \"text\",\n        style: styles.TextInput,\n        onChange: this.handleEmailChange,\n        value: this.state.email,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 9\n        }\n      })), this.state.emailError && _react.default.createElement(_reactNative.View, {\n        className: \"text-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 34\n        }\n      }, _react.default.createElement(_reactNative.Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 9\n        }\n      }, \"Email must be entered.\")), _react.default.createElement(_reactNative.View, {\n        style: styles.inputView,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 8\n        }\n      }, _react.default.createElement(_reactNative.TextInput, {\n        placeholder: \"Password\",\n        className: \"form-control\",\n        id: \"password\",\n        secureTextEntry: true,\n        style: styles.TextInput,\n        onChange: this.handlePasswordChange,\n        value: this.state.password,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 9\n        }\n      })), this.state.passwordError && _react.default.createElement(_reactNative.View, {\n        className: \"text-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 37\n        }\n      }, _react.default.createElement(_reactNative.Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 9\n        }\n      }, \" Password must be entered.\")), _react.default.createElement(_reactNative.TouchableHighlight, {\n        style: {\n          height: 40,\n          width: 300,\n          borderRadius: 80,\n          marginLeft: 50,\n          marginRight: 50,\n          marginTop: 20\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 8\n        }\n      }, _react.default.createElement(_reactNative.Button, {\n        onPress: this.handleLogin,\n        color: \"#ff0000\",\n        id: \"sendMessageButton\",\n        type: \"button\",\n        title: \"\\tLOGIN\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 8\n        }\n      })), _react.default.createElement(_reactNative.Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 7\n        }\n      }, \"Don't have an account? \"), _react.default.createElement(_reactNative.Text, {\n        style: {\n          color: 'blue'\n        },\n        onPress: function onPress() {\n          _this2.props.navigation.navigate('Signup');\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 7\n        }\n      }, \"Sign up\"));\n    }\n  }]);\n  return Login;\n}(_react.Component);\n\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  signupTextCont: {\n    flexGrow: 1,\n    alignItems: 'flex-end',\n    justifyContent: 'center',\n    paddingVertical: 16,\n    flexDirection: 'row'\n  },\n  signupText: {\n    color: 'rgba(255,255,255,0.6)',\n    fontSize: 16\n  },\n  signupButton: {\n    color: '#ffffff',\n    fontSize: 16,\n    fontWeight: '500'\n  },\n  image: {\n    marginBottom: 40\n  },\n  inputView: {\n    backgroundColor: \"#D3D3D3\",\n    borderRadius: 30,\n    width: \"70%\",\n    height: 45,\n    marginBottom: 20,\n    alignItems: \"center\"\n  },\n  TextInput: {\n    height: 50,\n    flex: 1,\n    padding: 10,\n    marginLeft: 20\n  },\n  loginText: {\n    height: 50,\n    flex: 1,\n    padding: 10,\n    marginLeft: 20\n  },\n  loginBtn: {\n    width: \"80%\",\n    borderRadius: 25,\n    height: 50,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: 40,\n    backgroundColor: \"#FF0000\"\n  }\n});\n\nvar _default = Login;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/Luna/Desktop/Diplomski/Android/android_app/src/pages/Login.js"],"names":["Login","state","errorHeader","errorMessage","hiddenErrorAlert","email","password","redirect","emailError","passwordError","openPasswordModal","oldPasswordEmptyError","newPasswordEmptyError","newPasswordRetypeEmptyError","newPasswordRetypeNotSameError","errorPasswordHeader","errorPasswordMessage","hiddenPasswordErrorAlert","handleEmailChange","event","setState","nativeEvent","text","handlePasswordChange","handleLogin","validateForm","loginDTO","console","log","Axios","post","BASE_URL","validateStatus","then","res","status","data","SyncStorage","set","accessToken","JSON","stringify","roles","Date","getTime","expiresIn","get","props","navigation","navigate","catch","err","handleCloseAlert","handlePasswordModalClose","handleCloseAlertPassword","Actions","signup","styles","container","image","require","inputView","TextInput","height","width","borderRadius","marginLeft","marginRight","marginTop","color","Component","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","signupTextCont","flexGrow","paddingVertical","flexDirection","signupText","fontSize","signupButton","fontWeight","marginBottom","padding","loginText","loginBtn"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n\tStyleSheet,\n\tText,\n\tView,\n\tStatusBar,\n\tTouchableOpacity,\n\tButton,\n\tTextInput,\n\tImage,\n\tLink,\n\tTouchableHighlight\n} from 'react-native';\nimport { BASE_URL } from \"../../constants.js\";\nimport Logo from '../components/Logo';\nimport Form from '../components/Form';\nimport Axios from \"axios\";\nimport AsyncStorage from '@react-native-community/async-storage'\nimport { Actions } from 'react-native-router-flux';\nimport { Redirect } from \"react-router-dom\";\nimport SyncStorage from 'sync-storage';\n\nclass Login extends Component {\n\tstate = {\n\t\terrorHeader: \"\",\n\t\terrorMessage: \"\",\n\t\thiddenErrorAlert: true,\n\t\temail: \"\",\n\t\tpassword: \"\",\n\t\tredirect: false,\n\t\temailError: false,\n\t\tpasswordError: false,\n\t\topenPasswordModal: false,\n\t\toldPasswordEmptyError: false,\n\t\tnewPasswordEmptyError: false,\n\t\tnewPasswordRetypeEmptyError: false,\n\t\tnewPasswordRetypeNotSameError: false,\n\t\terrorPasswordHeader: \"\",\n\t\terrorPasswordMessage: \"\",\n\t\thiddenPasswordErrorAlert: true\n\t};\n\thandleEmailChange = (event) => {\n\t\tthis.setState({ email: event.nativeEvent.text });\n\t};\n\thandlePasswordChange = (event) => {\n\t\tthis.setState({ password: event.nativeEvent.text });\n\t};\n\n\thandleLogin = () => {\n\t\tthis.setState({ hiddenErrorAlert: true, emailError: false, passwordError: false });\n\n\t\tif (this.validateForm()) {\n\t\t\tlet loginDTO = { email: this.state.email, password: this.state.password };\n\t\t\tconsole.log(loginDTO);\n\t\t\tAxios.post(BASE_URL + \"/api/auth/login\", loginDTO, { validateStatus: () => true })\n\t\t\t\t.then((res) => {\n\n\t\t\t\t\tif (res.status === 401) {\n\t\t\t\t\t\tthis.setState({ errorHeader: \"Bad credentials!\", errorMessage: \"Wrong username or password.\", hiddenErrorAlert: false });\n\t\t\t\t\t} else if (res.status === 500) {\n\t\t\t\t\t\tthis.setState({ errorHeader: \"Bad credentials!\", errorMessage: \"Wrong username or password.\", hiddenErrorAlert: false });\n\t\t\t\t\t} else if (res.status === 302) {\n\t\t\t\t\t\tthis.setState({ openPasswordModal: true });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log(res.data);\n\t\t\t\t\t\tSyncStorage.set(\"keyToken\", res.data.accessToken);\n\t\t\t\t\t\tSyncStorage.set(\"keyRole\", JSON.stringify(res.data.roles));\n\t\t\t\t\t\tSyncStorage.set(\"expireTime\", JSON.stringify(new Date(new Date().getTime() + res.data.expiresIn).getTime()));\n\n\t\t\t\t\t\tconsole.log(SyncStorage.get('keyRole'))\n\n\n\n\t\t\t\t\t\tthis.props.navigation.navigate('HomePage')\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tconsole.log(\"ERRRR\" + err);\n\t\t\t\t});\n\t\t}\n\t};\n\n\tvalidateForm = () => {\n\t\tif (this.state.email === \"\") {\n\t\t\tthis.setState({ emailError: true });\n\t\t\treturn false;\n\t\t} else if (this.state.password === \"\") {\n\t\t\tthis.setState({ passwordError: true });\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\thandleCloseAlert = () => {\n\t\tthis.setState({ hiddenErrorAlert: true });\n\t};\n\n\thandlePasswordModalClose = () => {\n\t\tthis.setState({ openPasswordModal: false });\n\t};\n\n\thandleCloseAlertPassword = () => {\n\t\tthis.setState({ hiddenPasswordErrorAlert: true });\n\t};\n\n\n\tsignup() {\n\t\tActions.signup()\n\t}\n\n\n\trender() {\n\t\tconst { navigate } = this.props.navigation;\n\t\tif (this.state.redirect) return <Redirect push to=\"/TShirtsWomen\" />;\n\t\treturn (\n\n\t\t\t<View  style={styles.container}>\n\n\n\n\t\t\t\t\t<Image style={styles.image} source={require(\"../images/01-APEIRON-LOGO-new.png\")} />\n\t\t\t\t\t\t\t<View style={styles.inputView} >\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tplaceholder=\"Email address\"\n\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\t\t\tid=\"name\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tstyle={styles.TextInput}\n\t\t\t\t\t\t\t\t\tonChange={this.handleEmailChange}\n\t\t\t\t\t\t\t\t\tvalue={this.state.email}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t{this.state.emailError && <View className=\"text-danger\" >\n\t\t\t\t\t\t\t\t<Text>Email must be entered.</Text>\n\t\t\t\t\t\t\t</View>}\n\t\t\t\t\t\n\n\t\t\t\t\t\t\t<View style={styles.inputView}>\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tplaceholder=\"Password\"\n\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\t\t\t\tsecureTextEntry={true}\n\t\t\t\t\t\t\t\t\tstyle={styles.TextInput}\n\t\t\t\t\t\t\t\t\tonChange={this.handlePasswordChange}\n\t\t\t\t\t\t\t\t\tvalue={this.state.password}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t{this.state.passwordError && <View className=\"text-danger\" >\n\t\t\t\t\t\t\t\t<Text>\tPassword must be entered.</Text>\n\t\t\t\t\t\t\t</View>}\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t\t<TouchableHighlight \n                style ={{\n                    height: 40,\n                    width:300,\n                    borderRadius:80,\n                    marginLeft :50,\n                    marginRight:50,\n                    marginTop :20\n                }}>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tonPress={this.handleLogin}\n\t\t\t\t\t\t\t\tcolor=\"#ff0000\"\n\t\t\t\t\t\t\t\tid=\"sendMessageButton\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ttitle=\"\tLOGIN\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</TouchableHighlight>\n\n\n\n\t\t\t\t\t\t<Text>Don't have an account? </Text>\n\t\t\t\t\t\t<Text style={{color: 'blue'}}\n      onPress={() => {\n\t\tthis.props.navigation.navigate('Signup')}}>\n  Sign up\n</Text>\n\n\t\t\t</View>\n\n\n\n\n\t\t);\n\t}\n}\n\n\n\nconst styles = StyleSheet.create({\n\tcontainer: {\n\t\tflex: 1,\n\t\tbackgroundColor: \"#fff\",\n\t\talignItems: \"center\",\n\t\tjustifyContent: \"center\",\n\t  },\n\tsignupTextCont: {\n\t\tflexGrow: 1,\n\t\talignItems: 'flex-end',\n\t\tjustifyContent: 'center',\n\t\tpaddingVertical: 16,\n\t\tflexDirection: 'row'\n\t},\n\tsignupText: {\n\t\tcolor: 'rgba(255,255,255,0.6)',\n\t\tfontSize: 16\n\t},\n\tsignupButton: {\n\t\tcolor: '#ffffff',\n\t\tfontSize: 16,\n\t\tfontWeight: '500'\n\t},\n\timage: {\n\t\tmarginBottom: 40,\n\t  },\n\t  inputView: {\n\t\tbackgroundColor: \"#D3D3D3\",\n\t\tborderRadius: 30,\n\t\twidth: \"70%\",\n\t\theight: 45,\n\t\tmarginBottom: 20,\n\t\n\t\talignItems: \"center\",\n\t  },\n\t  TextInput: {\n\t\theight: 50,\n\t\tflex: 1,\n\t\tpadding: 10,\n\t\tmarginLeft: 20,\n\t  }, \n\t  loginText: {\n\t\theight: 50,\n\t\tflex: 1,\n\t\tpadding: 10,\n\t\tmarginLeft: 20,\n\t  }, \n\t  loginBtn: {\n\t\twidth: \"80%\",\n\t\tborderRadius: 25,\n\t\theight: 50,\n\t\talignItems: \"center\",\n\t\tjustifyContent: \"center\",\n\t\tmarginTop: 40,\n\t\tbackgroundColor: \"#FF0000\",\n\t  },\n\t\n});\n\n\n\nexport default Login;"]},"metadata":{},"sourceType":"script"}